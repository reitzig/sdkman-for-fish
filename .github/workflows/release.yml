name: Release

on:
  push:
    tags:
      - 'v*'

jobs:
  release:
    name: "Create Release"
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@93cb6efe18208431cddfb8368fd83d5badbf9bfd # v5

      - name: Is pre-release?
        id: is_pre_release
        run: |
          version="${GITHUB_REF#refs/tags/}"
          if [[ "${version}" =~ -.*$ ]]; then
            echo ::set-output name=IS_PRERELEASE::true
          else
            echo ::set-output name=IS_PRERELEASE::false
          fi

      - name: Release
        uses: docker://antonyurchenko/git-release:v5@sha256:8af09b24c3d96c2d5cc1c383ad9e38fdc578f4f33d7ec67b0a61378ed04794ef
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          DRAFT_RELEASE: "true"
          PRE_RELEASE: ${{ steps.is_pre_release.outputs.IS_PRERELEASE }}
          ALLOW_EMPTY_CHANGELOG: "false"
